<Page x:Class="Argus_WPF.Pages.DelegatorPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:controls="http://metro.mahapps.com/winfx/xaml/controls"
      mc:Ignorable="d"
      Background="{DynamicResource MahApps.Brushes.Background}">

    <!-- ❕ Стили (GroupBox/PrimaryButton/и т.п.) уже объявлены в App.xaml → здесь не дублируем -->

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- 🧠 Заголовок -->
        <Border Grid.Row="0" Padding="20,10"
                Background="{DynamicResource MahApps.Brushes.Accent}">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="🤖" FontSize="28" Margin="0,0,10,0"/>
                <TextBlock Text="BOT.DELEGATOR — Система делегирования"
                           FontSize="24" FontWeight="Bold"
                           Foreground="{DynamicResource MahApps.Brushes.TextOnAccent}"/>
            </StackPanel>
        </Border>

        <!-- 📊 Контент -->
        <ScrollViewer Grid.Row="1" Margin="20">
            <StackPanel>

                <!-- 1. Интеграции -->
                <GroupBox Header="🔌 Интеграции с сервисами">
                    <StackPanel>

                        <WrapPanel ItemWidth="200">
                            <CheckBox Content="Google Calendar"
                                      IsChecked="{Binding IsGoogleCalendarEnabled}"
                                      Margin="10"/>
                            <CheckBox Content="Gmail"
                                      IsChecked="{Binding IsGmailEnabled}"
                                      Margin="10"/>
                            <CheckBox Content="Google Sheets"
                                      IsChecked="{Binding IsGoogleSheetsEnabled}"
                                      Margin="10"/>
                            <CheckBox Content="Trello"
                                      IsChecked="{Binding IsTrelloEnabled}"
                                      Margin="10"/>
                            <CheckBox Content="Notion"
                                      IsChecked="{Binding IsNotionEnabled}"
                                      Margin="10"/>
                            <CheckBox Content="Asana"
                                      IsChecked="{Binding IsAsanaEnabled}"
                                      Margin="10"/>
                        </WrapPanel>

                        <!-- параметры API -->
                        <StackPanel Orientation="Horizontal" Margin="0,10">
                            <TextBox Width="220"
                                     controls:TextBoxHelper.Watermark="email@example.com"
                                     Text="{Binding Email, UpdateSourceTrigger=PropertyChanged}"
                                     Margin="0,0,10,0"/>

                            <DatePicker SelectedDate="{Binding StartDate}"
                                        Margin="0,0,10,0"/>
                            <DatePicker SelectedDate="{Binding EndDate}"/>
                        </StackPanel>

                        <!-- Импорт -->
                        <Button Style="{StaticResource PrimaryButton}"
                                Content="📥 Импортировать данные"
                                Command="{Binding ImportDataCommand}"
                                Width="220" Margin="10,15,0,0"/>
                    </StackPanel>
                </GroupBox>

                <!-- 2. Анализ -->
                <GroupBox Header="🧠 Анализ активности">
                    <StackPanel>

                        <TextBlock Text="📍 Повторяющиеся задачи:" FontWeight="Bold"/>
                        <ListBox ItemsSource="{Binding RepeatingTasks}"
                 Height="80" Margin="0,5"/>

                        <TextBlock Text="📂 Классификация задач:" FontWeight="Bold"
                   Margin="0,10,0,0"/>
                        <DataGrid ItemsSource="{Binding Classifications}"
                  AutoGenerateColumns="False" Height="180">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Задача"
                                    Binding="{Binding Task}" Width="*"/>
                                <DataGridTextColumn Header="Тип"
                                    Binding="{Binding Type}" Width="150"/>
                                <DataGridTextColumn Header="Время (ч)"
                                    Binding="{Binding Hours}" Width="100"/>
                            </DataGrid.Columns>
                        </DataGrid>

                        <!-- ✅ правильный биндинг -->
                        <Button Style="{StaticResource PrimaryButton}"
                Content="🔍 Выполнить анализ"
                Command="{Binding AnalyzeCommand}"
                Width="180" Margin="0,10,0,0"/>
                    </StackPanel>
                </GroupBox>

                <!-- 3. Карта делегирования -->
                <GroupBox Header="📤 Карта делегирования и инструкции">
                    <StackPanel>

                        <TextBlock Text="📌 Задачи, которые можно делегировать:"
                                   FontWeight="Bold"/>
                        <ListBox ItemsSource="{Binding DelegatableTasks}"
                                 Height="80" Margin="0,5"/>

                        <TextBlock Text="📝 Шаблон инструкции:"
                                   FontWeight="Bold" Margin="0,10,0,0"/>
                        <TextBox Text="{Binding InstructionTemplate, Mode=TwoWay}"
                                 AcceptsReturn="True" Height="100" TextWrapping="Wrap"/>

                        <Button Style="{StaticResource PrimaryButton}"
                                Content="📄 Сгенерировать инструкцию"
                                Command="{Binding GenerateInstructionCommand}"
                                Width="240" Margin="0,10,0,0"/>
                    </StackPanel>
                </GroupBox>

                <!-- 4. Отчёт -->
                <GroupBox Header="📈 Ежемесячный отчёт и рекомендации">
                    <StackPanel>

                        <TextBlock Text="📊 Ежемесячный отчёт:" FontWeight="Bold"/>
                        <TextBox Text="{Binding MonthlyReport, Mode=TwoWay}"
                                 AcceptsReturn="True" Height="100" TextWrapping="Wrap"/>

                        <TextBlock Text="🤔 Где искать исполнителей?"
                                   FontWeight="Bold" Margin="0,10,0,0"/>
                        <ComboBox SelectedItem="{Binding SelectedHiringStrategy, Mode=TwoWay}"
                                  Width="200">
                            <ComboBoxItem Content="Фриланс"/>
                            <ComboBoxItem Content="Аутсорс"/>
                            <ComboBoxItem Content="Штатный сотрудник"/>
                        </ComboBox>

                        <Button Style="{StaticResource PrimaryButton}"
                                Content="📤 Сформировать рекомендации"
                                Command="{Binding GenerateReportCommand}"
                                Width="260" Margin="0,10,0,0"/>
                    </StackPanel>
                </GroupBox>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>
